<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>성경 암송 짝짝짝</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Jua&family=Noto+Sans+KR:wght@400;700&display=swap" rel="stylesheet">
    
    <!-- React & ReactDOM (Development versions for easier debugging via CDN, use Production for live if preferred) -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- Babel for JSX transformation in browser -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <script>
      tailwind.config = {
        theme: {
          extend: {
            fontFamily: {
              sans: ['"Noto Sans KR"', 'sans-serif'],
              display: ['"Jua"', 'sans-serif'],
            },
            colors: {
              'bible-blue': '#e0f2fe', // sky-100
              'bible-dark': '#0c4a6e', // sky-900
            },
            animation: {
              'spin-slow': 'spin 3s linear infinite',
            }
          }
        }
      }
    </script>
  <script type="importmap">
{
  "imports": {
    "react": "https://aistudiocdn.com/react@^19.2.0",
    "lucide-react": "https://aistudiocdn.com/lucide-react@^0.554.0",
    "react/": "https://aistudiocdn.com/react@^19.2.0/",
    "@google/genai": "https://aistudiocdn.com/@google/genai@^1.30.0"
  }
}
</script>
</head>
  <body class="bg-bible-blue min-h-screen">
    <div id="root"></div>

    <script type="text/babel">
      const { useState, useEffect, useCallback } = React;

      // --- Icons (Inline SVGs for standalone compatibility) ---
      const Sun = ({ className }) => (
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
          <circle cx="12" cy="12" r="4" /><path d="M12 2v2" /><path d="M12 20v2" /><path d="m4.93 4.93 1.41 1.41" /><path d="m17.66 17.66 1.41 1.41" /><path d="M2 12h2" /><path d="M20 12h2" /><path d="m6.34 17.66-1.41-1.41" /><path d="m19.07 4.93-1.41 1.41" />
        </svg>
      );
      const Heart = ({ className }) => (
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
          <path d="M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z" />
        </svg>
      );
      const BookOpen = ({ className }) => (
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
          <path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z" /><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z" />
        </svg>
      );
      const RefreshCw = ({ className }) => (
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
          <path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8" /><path d="M21 3v5h-5" /><path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16" /><path d="M8 21H3v-5" />
        </svg>
      );
      const Star = ({ className }) => (
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
          <polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2" />
        </svg>
      );
      const Trophy = ({ className }) => (
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
          <path d="M6 9H4.5a2.5 2.5 0 0 1 0-5H6" /><path d="M18 9h1.5a2.5 2.5 0 0 0 0-5H18" /><path d="M4 22h16" /><path d="M10 14.66V17" /><path d="M14 14.66V17" /><path d="M18 2H6v7a6 6 0 0 0 12 0V2Z" /><path d="M8.5 22v-2.08" /><path d="M15.5 22v-2.08" />
        </svg>
      );
      const Sparkles = ({ className }) => (
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
          <path d="m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z" /><path d="M5 3v4" /><path d="M9 3v4" /><path d="M3 5h4" /><path d="M3 9h4" />
        </svg>
      );

      // --- Components ---

      const WordDisplay = ({ word, isHidden }) => {
        const maskedText = "O".repeat(word.length);
        return (
          <span
            className={`
              inline-block text-2xl md:text-4xl font-bold transition-all duration-500 ease-in-out px-1 py-1 rounded-md
              ${isHidden 
                ? 'text-sky-200 bg-sky-50 scale-95 select-none tracking-widest' 
                : 'text-slate-700 scale-100 tracking-normal'
              }
            `}
          >
            {isHidden ? maskedText : word}
          </span>
        );
      };

      const ProgressBar = ({ progress }) => {
        return (
          <div className="w-full h-4 bg-slate-100 rounded-full overflow-hidden shadow-inner ring-1 ring-slate-200">
            <div
              className="h-full bg-gradient-to-r from-sky-300 to-sky-500 transition-all duration-500 ease-out"
              style={{ width: `${progress}%` }}
            />
          </div>
        );
      };

      const VERSE_TEXT = "하나님이 세상을 이처럼 사랑하사 독생자를 주셨으니 이는 그를 믿는 자마다 멸망하지 않고 영생을 얻게 하려 하심이라";
      const VERSE_REF = "요한복음 3장 16절";

      const MemoryGame = () => {
        const [words, setWords] = useState([]);
        const [hiddenIndices, setHiddenIndices] = useState(new Set());
        const [isCompleted, setIsCompleted] = useState(false);

        useEffect(() => {
          setWords(VERSE_TEXT.split(' '));
        }, []);

        useEffect(() => {
          if (words.length > 0 && hiddenIndices.size === words.length) {
            setIsCompleted(true);
          } else {
            setIsCompleted(false);
          }
        }, [hiddenIndices, words]);

        const handleLevelUp = useCallback(() => {
          const availableIndices = words
            .map((_, index) => index)
            .filter((index) => !hiddenIndices.has(index));

          if (availableIndices.length === 0) return;

          const randomIndex = Math.floor(Math.random() * availableIndices.length);
          const wordIndexToHide = availableIndices[randomIndex];

          setHiddenIndices((prev) => {
            const newSet = new Set(prev);
            newSet.add(wordIndexToHide);
            return newSet;
          });
        }, [words, hiddenIndices]);

        const handleReset = () => {
          setHiddenIndices(new Set());
          setIsCompleted(false);
        };

        const progress = words.length > 0 ? (hiddenIndices.size / words.length) * 100 : 0;

        return (
          <div className="bg-white rounded-3xl shadow-xl p-6 md:p-10 border-4 border-white ring-4 ring-sky-100 transition-all duration-300">
            <div className="flex justify-center mb-6">
              <span className="bg-sky-100 text-sky-700 font-display text-xl md:text-2xl px-6 py-2 rounded-full shadow-inner">
                {VERSE_REF}
              </span>
            </div>

            <div className="min-h-[200px] flex flex-wrap content-center justify-center gap-x-3 gap-y-4 mb-8 text-center">
              {words.map((word, index) => (
                <WordDisplay
                  key={index}
                  word={word}
                  isHidden={hiddenIndices.has(index)}
                />
              ))}
            </div>

            <div className="mb-8">
              <ProgressBar progress={progress} />
            </div>

            <div className="flex flex-col items-center space-y-4">
              {!isCompleted ? (
                <button
                  onClick={handleLevelUp}
                  className="group relative w-full max-w-sm bg-sky-500 hover:bg-sky-400 active:bg-sky-600 text-white font-display text-2xl py-4 rounded-2xl shadow-lg transition-all transform hover:-translate-y-1 active:translate-y-0"
                >
                  <span className="flex items-center justify-center space-x-2">
                    <Star className="w-6 h-6 fill-yellow-300 text-yellow-300 group-hover:animate-spin" />
                    <span>암송 단계 올리기!</span>
                    <Star className="w-6 h-6 fill-yellow-300 text-yellow-300 group-hover:animate-spin" />
                  </span>
                </button>
              ) : (
                <div className="flex flex-col items-center animate-bounce">
                  <div className="flex items-center space-x-2 text-yellow-500 mb-2">
                    <Trophy className="w-10 h-10 fill-yellow-400" />
                    <Sparkles className="w-8 h-8 text-yellow-400" />
                  </div>
                  <p className="text-2xl font-display text-sky-600 mb-4">참 잘했어요!</p>
                </div>
              )}

              <button
                onClick={handleReset}
                className="flex items-center space-x-2 text-slate-400 hover:text-slate-600 font-medium transition-colors px-4 py-2 rounded-lg hover:bg-slate-100"
              >
                <RefreshCw className={`w-4 h-4 ${hiddenIndices.size > 0 ? '' : 'opacity-50'}`} />
                <span>처음부터 다시하기</span>
              </button>
            </div>
          </div>
        );
      };

      const App = () => {
        return (
          <div className="min-h-screen bg-gradient-to-b from-sky-100 to-sky-50 flex flex-col items-center py-10 px-4 font-sans text-slate-800">
            <header className="w-full max-w-3xl flex flex-col items-center mb-8 text-center space-y-2">
              <div className="flex items-center space-x-2 text-sky-500 mb-2">
                <Sun className="w-8 h-8 animate-spin-slow" />
                <Heart className="w-6 h-6 fill-sky-400 text-sky-400 animate-pulse" />
                <Sun className="w-8 h-8 animate-spin-slow" />
              </div>
              <h1 className="text-4xl md:text-5xl font-display text-sky-600 drop-shadow-sm">
                말씀 암송 챌린지
              </h1>
              <p className="text-slate-500 font-medium">
                하나님의 말씀을 마음에 새겨보아요!
              </p>
            </header>

            <main className="w-full max-w-2xl">
              <MemoryGame />
            </main>

            <footer className="mt-12 text-slate-400 text-sm flex items-center space-x-2">
              <BookOpen className="w-4 h-4" />
              <span>주일학교 말씀 공부</span>
            </footer>
          </div>
        );
      };

      const root = ReactDOM.createRoot(document.getElementById('root'));
      root.render(
        <React.StrictMode>
          <App />
        </React.StrictMode>
      );
    </script>
  </body>
</html>